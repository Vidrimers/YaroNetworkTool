# –®–ø–∞—Ä–≥–∞–ª–∫–∞ –ø–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é VPN —Å–∏—Å—Ç–µ–º–æ–π

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh root@144.124.237.222

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
pm2 status

# –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
pm2 logs
```

## üì¶ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ PM2

### –°—Ç–∞—Ç—É—Å –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```bash
pm2 list                    # –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pm2 status                  # –°—Ç–∞—Ç—É—Å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–µ—Å—É—Ä—Å–æ–≤
pm2 monit                   # –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
pm2 show vpn-api            # –î–µ—Ç–∞–ª–∏ API
pm2 show vpn-bot            # –î–µ—Ç–∞–ª–∏ –±–æ—Ç–∞
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
```bash
pm2 restart vpn-api         # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å API
pm2 restart vpn-bot         # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
pm2 restart all             # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ
```

### –õ–æ–≥–∏
```bash
pm2 logs                    # –í—Å–µ –ª–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
pm2 logs vpn-api            # –õ–æ–≥–∏ API
pm2 logs vpn-bot            # –õ–æ–≥–∏ –±–æ—Ç–∞
pm2 logs --lines 100        # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫
pm2 flush                   # –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ª–æ–≥–∏
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞/–ó–∞–ø—É—Å–∫
```bash
pm2 stop vpn-api            # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å API
pm2 stop vpn-bot            # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞
pm2 start vpn-api           # –ó–∞–ø—É—Å—Ç–∏—Ç—å API
pm2 start vpn-bot           # –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
```

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Git

### –û–±–Ω–æ–≤–∏—Ç—å API
```bash
cd ~/xray-vpn
./scripts/kvn.sh
```

### –û–±–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞
```bash
cd ~/yaronetworktool
./bot/kvn-bot.sh
```

### –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
```bash
cd ~/xray-vpn
./scripts/kvn-stop.sh        # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å API

cd ~/yaronetworktool
./bot/kvn-bot-stop.sh        # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞
```

**–°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- ‚úÖ –ü–æ–ª—É—á–∞—é—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (git pull)
- ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—é—Ç —á–µ—Ä–µ–∑ PM2
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç —Å—Ç–∞—Ç—É—Å

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** npm install –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –≤ —Å–∫—Ä–∏–ø—Ç–µ –µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è package.json.

## üóÑÔ∏è –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

### –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ
```bash
sqlite3 ~/xray-vpn/database/vpn.db
```

### –ü–æ–ª–µ–∑–Ω—ã–µ SQL –∫–æ–º–∞–Ω–¥—ã
```sql
-- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
SELECT * FROM clients;

-- –ê–∫—Ç–∏–≤–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã
SELECT name, uuid, subscription_end FROM clients WHERE status = 'active';

-- –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ
SELECT * FROM extension_requests WHERE status = 'pending';

-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç—Ä–∞—Ñ–∏–∫–∞
SELECT client_uuid, SUM(bytes_sent + bytes_received) as total 
FROM traffic_logs 
GROUP BY client_uuid;

-- –í—ã—Ö–æ–¥
.quit
```

### –ë—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
# –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø
cp ~/xray-vpn/database/vpn.db ~/xray-vpn-backup/vpn_$(date +%Y%m%d).db

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –±—ç–∫–∞–ø–∞
cp ~/xray-vpn-backup/vpn_20260126.db ~/xray-vpn/database/vpn.db
pm2 restart all
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### API
```bash
# Health check
curl http://localhost:333/health

# –°–ø–∏—Å–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤
curl http://localhost:333/api/v1/clients

# –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ
curl http://localhost:333/api/v1/extension-requests
```

### –ë–æ—Ç
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
pm2 show vpn-bot

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
pm2 logs vpn-bot --lines 50

# –û—Ç–ø—Ä–∞–≤–∏—Ç—å /start –±–æ—Ç—É –≤ Telegram
```

## üìù –õ–æ–≥–∏

### –õ–æ–≥–∏ PM2
```bash
pm2 logs vpn-api --lines 100
pm2 logs vpn-bot --lines 100
```

### –õ–æ–≥–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
```bash
tail -f /var/log/kvn-deployment.log
tail -f /var/log/kvn-bot-deployment.log
```

### –õ–æ–≥–∏ X-Ray
```bash
tail -f /var/log/xray/access.log
tail -f /var/log/xray/error.log
```

## üõ†Ô∏è CLI —Å–∫—Ä–∏–ø—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞–º–∏
```bash
cd ~/xray-vpn/scripts

./add-client.sh              # –î–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞
./remove-client.sh           # –£–¥–∞–ª–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞
./list-clients.sh            # –°–ø–∏—Å–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤
./generate-client-link.sh    # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
```bash
./validate-config.sh         # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
./apply-config.sh            # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
./sync-clients.sh            # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤
```

## üîß Troubleshooting

### API –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
pm2 show vpn-api

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
pm2 logs vpn-api --lines 100

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—Ç
netstat -tulpn | grep 3000

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
pm2 restart vpn-api

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å .env
cat /opt/xray-vpn/.env
```

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
pm2 show vpn-bot

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
pm2 logs vpn-bot --lines 100

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω
cat /opt/yaronetworktool/.env | grep TELEGRAM_BOT_TOKEN

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
pm2 restart vpn-bot
```

### –û—Ç–∫–∞—Ç–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
```bash
# API
cd ~/xray-vpn
git reset --hard HEAD@{1}
pm2 restart vpn-api

# –ë–æ—Ç
cd ~/yaronetworktool
git reset --hard HEAD@{1}
pm2 restart vpn-bot
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –±—ç–∫–∞–ø–∞
```bash
# –ù–∞–π—Ç–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –±—ç–∫–∞–ø
ls -lt ~/xray-vpn-backup/vpn_*.db | head -1

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
cd ~/xray-vpn
cp ~/xray-vpn-backup/vpn_20260126_123456.db database/vpn.db
pm2 restart vpn-api
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞
```bash
df -h                        # –û–±—â–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
du -sh /opt/xray-vpn         # –†–∞–∑–º–µ—Ä API
du -sh /opt/yaronetworktool  # –†–∞–∑–º–µ—Ä –±–æ—Ç–∞
du -sh /opt/*-backup         # –†–∞–∑–º–µ—Ä –±—ç–∫–∞–ø–æ–≤
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
```bash
free -h                      # –û–±—â–∞—è –ø–∞–º—è—Ç—å
pm2 status                   # –ü–∞–º—è—Ç—å –ø–æ –ø—Ä–æ—Ü–µ—Å—Å–∞–º
```

### –°–µ—Ç–µ–≤—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
```bash
netstat -tulpn               # –í—Å–µ –ø–æ—Ä—Ç—ã
netstat -tulpn | grep 333    # API –ø–æ—Ä—Ç
ss -s                        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ–∫–µ—Ç–æ–≤
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ .env
```bash
ls -la ~/xray-vpn/.env
ls -la ~/yaronetworktool/.env
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: -rw------- (600)
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π—Ä–≤–æ–ª
```bash
ufw status                   # –°—Ç–∞—Ç—É—Å —Ñ–∞–π—Ä–≤–æ–ª–∞
ufw status numbered          # –ü—Ä–æ–Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π
```bash
who                          # –ö—Ç–æ –ø–æ–¥–∫–ª—é—á–µ–Ω
last                         # –ò—Å—Ç–æ—Ä–∏—è –≤—Ö–æ–¥–æ–≤
```

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- **–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** `~/xray-vpn/DEPLOYMENT-GUIDE.md`
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** `~/yaronetworktool/docs/TESTING.md`
- **–ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç:** `~/xray-vpn/QUICK-TEST.md`
- **Changelog –±–æ—Ç–∞:** `~/yaronetworktool/docs/CHANGELOG.md`

## üéØ –¢–∏–ø–∏—á–Ω—ã–µ –∑–∞–¥–∞—á–∏

### –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ –±–æ—Ç
1. –û—Ç–ø—Ä–∞–≤–∏—Ç—å `/add_client` –±–æ—Ç—É
2. –í–≤–µ—Å—Ç–∏ –∏–º—è, Telegram ID, –¥–Ω–∏ –ø–æ–¥–ø–∏—Å–∫–∏
3. –ö–ª–∏–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### –ü—Ä–æ–¥–ª–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –∫–ª–∏–µ–Ω—Ç—É
1. –ö–ª–∏–µ–Ω—Ç –Ω–∞–∂–∏–º–∞–µ—Ç `üîë –ó–∞–ø—Ä–æ—Å–∏—Ç—å –∫–ª—é—á`
2. –í—ã–±–∏—Ä–∞–µ—Ç –ø–µ—Ä–∏–æ–¥ (1-12 –º–µ—Å—è—Ü–µ–≤)
3. –ê–¥–º–∏–Ω –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
4. –ê–¥–º–∏–Ω –Ω–∞–∂–∏–º–∞–µ—Ç `‚úÖ –†–∞–∑—Ä–µ—à–∏—Ç—å`
5. –ü–æ–¥–ø–∏—Å–∫–∞ –ø—Ä–æ–¥–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### –û–±–Ω–æ–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥–µ
```bash
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ
git add .
git commit -m "–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
git push origin main

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh root@144.124.237.222
cd ~/xray-vpn && ./scripts/kvn.sh
cd ~/yaronetworktool && ./bot/kvn-bot.sh
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
```bash
pm2 status                              # –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã online
curl http://localhost:333/health        # API –æ—Ç–≤–µ—á–∞–µ—Ç
pm2 logs vpn-bot --lines 10             # –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç
```

---

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```bash
pm2 status                   # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
pm2 logs                     # –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
cd ~/xray-vpn && ./scripts/kvn.sh             # –û–±–Ω–æ–≤–∏—Ç—å API
cd ~/yaronetworktool && ./bot/kvn-bot.sh      # –û–±–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞
cd ~/xray-vpn && ./scripts/kvn-stop.sh        # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å API
cd ~/yaronetworktool && ./bot/kvn-bot-stop.sh # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞
```
