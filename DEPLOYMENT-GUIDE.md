# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é VPN Management System

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

```
VPN –°–µ—Ä–≤–µ—Ä (144.124.237.222)
‚îú‚îÄ‚îÄ ~/xray-vpn/                 # –û—Å–Ω–æ–≤–Ω–æ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ api/server.js           # Management API (–ø–æ—Ä—Ç 3000)
‚îÇ   ‚îú‚îÄ‚îÄ database/vpn.db         # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite
‚îÇ   ‚îú‚îÄ‚îÄ configs/                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ X-Ray
‚îÇ   ‚îî‚îÄ‚îÄ scripts/                # CLI —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ
‚îú‚îÄ‚îÄ ~/yaronetworktool/          # Telegram –±–æ—Ç
‚îÇ   ‚îî‚îÄ‚îÄ bot/yaronetworktool_bot.js
‚îÇ
‚îî‚îÄ‚îÄ /usr/local/etc/xray/        # X-Ray Core
    ‚îî‚îÄ‚îÄ config.json
```

## –ß–∞—Å—Ç—å 1: –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### –®–∞–≥ 1: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É

```bash
ssh root@144.124.237.222
```

### –®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```bash
# –û–±–Ω–æ–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É
apt update && apt upgrade -y

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Node.js 18+
curl -fsSL https://deb.nodesource.com/setup_18.x | bash -
apt install -y nodejs

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PM2 –≥–ª–æ–±–∞–ª—å–Ω–æ
npm install -g pm2

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Git (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
apt install -y git

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å SQLite3
apt install -y sqlite3

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏–∏
node --version    # –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å >= 18.0.0
npm --version
pm2 --version
git --version
```

### –®–∞–≥ 3: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–æ–º–∞—à–Ω—é—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd ~

# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (–∑–∞–º–µ–Ω–∏—Ç–µ URL –Ω–∞ –≤–∞—à)
git clone https://github.com/YOUR_USERNAME/xray-vpn-server.git xray-vpn

# –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd xray-vpn

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install --production
```

### –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env –¥–ª—è API

```bash
# –°–æ–∑–¥–∞—Ç—å .env —Ñ–∞–π–ª
cat > .env << 'EOF'
# API Configuration
API_PORT=3000
NODE_ENV=production

# Database
DB_PATH=~/xray-vpn/database/vpn.db

# JWT Secret (—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å–ª—É—á–∞–π–Ω—É—é —Å—Ç—Ä–æ–∫—É)
JWT_SECRET=your-super-secret-jwt-key-change-this

# Server
SERVER_IP=144.124.237.222
EOF

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∞
chmod 600 .env
```

### –®–∞–≥ 5: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
mkdir -p ~/xray-vpn/database

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
sqlite3 ~/xray-vpn/database/vpn.db < database/init.sql

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã
sqlite3 ~/xray-vpn/database/vpn.db "SELECT name FROM sqlite_master WHERE type='table';"

# –î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è: clients, extension_requests, traffic_logs
```

### –®–∞–≥ 6: –ó–∞–ø—É—Å–∫ API —á–µ—Ä–µ–∑ PM2

```bash
cd ~/xray-vpn

# –ó–∞–ø—É—Å—Ç–∏—Ç—å API
pm2 start api/server.js --name vpn-api --time

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
pm2 status

# –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
pm2 logs vpn-api --lines 50

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é PM2 –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
pm2 save
pm2 startup
# –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –∫–æ—Ç–æ—Ä—É—é –≤—ã–≤–µ–¥–µ—Ç pm2 startup
```

### –®–∞–≥ 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã API

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å health endpoint
curl http://localhost:3000/health

# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å: {"status":"ok","timestamp":"..."}

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—É—Å—Ç–æ–π)
curl http://localhost:3000/api/v1/clients

# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å: {"success":true,"count":0,"clients":[]}
```

## –ß–∞—Å—Ç—å 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Telegram –±–æ—Ç–∞

### –®–∞–≥ 1: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –±–æ—Ç–∞

```bash
cd ~

# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (–∑–∞–º–µ–Ω–∏—Ç–µ URL –Ω–∞ –≤–∞—à)
git clone https://github.com/YOUR_USERNAME/yaronetworktool.git yaronetworktool

# –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd yaronetworktool

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install --production
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env –¥–ª—è –±–æ—Ç–∞

```bash
# –°–æ–∑–¥–∞—Ç—å .env —Ñ–∞–π–ª
cat > .env << 'EOF'
# Telegram Bot Configuration
TELEGRAM_BOT_TOKEN=8203314241:AAG53unoLQMWfLMYxWNYdPMeG1TGeWCS50Q
TELEGRAM_ADMIN_ID=137981675

# API Configuration (–ª–æ–∫–∞–ª—å–Ω—ã–π API –Ω–∞ —Ç–æ–º –∂–µ —Å–µ—Ä–≤–µ—Ä–µ)
API_BASE_URL=http://localhost:3000
SERVER_IP=144.124.237.222

# Database (–∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç—É –∂–µ –±–∞–∑—É —á—Ç–æ –∏ API)
DB_PATH=~/xray-vpn/database/vpn.db

# SSH Configuration (–Ω–µ –Ω—É–∂–Ω–æ –µ—Å–ª–∏ –Ω–∞ —Ç–æ–º –∂–µ —Å–µ—Ä–≤–µ—Ä–µ)
# SSH_HOST=localhost
# SSH_PORT=22
# SSH_USER=root
# SSH_PASSWORD=your-password
EOF

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∞
chmod 600 .env
```

### –®–∞–≥ 3: –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ PM2

```bash
cd ~/yaronetworktool

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
pm2 start bot/yaronetworktool_bot.js --name vpn-bot --time

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
pm2 status

# –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
pm2 logs vpn-bot --lines 50

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
pm2 save
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω
pm2 list

# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–≤–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞:
# - vpn-api (online)
# - vpn-bot (online)

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –±–æ—Ç–∞
pm2 logs vpn-bot --lines 20

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: "[YaroNetworkTool VPN Bot] –ó–∞–ø—É—â–µ–Ω"
```

–¢–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤—å—Ç–µ `/start` –±–æ—Ç—É –≤ Telegram - –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è –º–µ–Ω—é!

## –ß–∞—Å—Ç—å 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ Git

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

```bash
# –°–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏
chmod +x ~/xray-vpn/scripts/kvn.sh
chmod +x ~/xray-vpn/scripts/kvn-stop.sh
chmod +x ~/yaronetworktool/bot/kvn-bot.sh
chmod +x ~/yaronetworktool/bot/kvn-bot-stop.sh
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ API (—Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ –∏ –±—ç–∫–∞–ø–∞–º–∏):**
```bash
cd ~/xray-vpn
./scripts/kvn.sh
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç kvn.sh:**
1. ‚úÖ –°–æ–∑–¥–∞–µ—Ç –±—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
3. ‚úÖ –ü–æ–ª—É—á–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∑ Git (git pull)
4. ‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è package.json
5. ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç —á–µ—Ä–µ–∑ PM2
6. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç health endpoint
7. ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ
8. ‚úÖ –û—á–∏—â–∞–µ—Ç —Å—Ç–∞—Ä—ã–µ –±—ç–∫–∞–ø—ã

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞ (–±—ã—Å—Ç—Ä–æ–µ):**
```bash
cd ~/yaronetworktool
./bot/kvn-bot.sh
```

**–û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤:**
```bash
cd ~/xray-vpn
./scripts/kvn-stop.sh        # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å API

cd ~/yaronetworktool
./bot/kvn-bot-stop.sh        # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç kvn-bot.sh:**
1. ‚úÖ –ü–æ–ª—É—á–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∑ Git (git pull)
2. ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç —á–µ—Ä–µ–∑ PM2
3. ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –í kvn-bot.sh –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (npm install) –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ. –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è package.json.

## –ß–∞—Å—Ç—å 4: –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã PM2

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏

```bash
# –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pm2 list

# –°—Ç–∞—Ç—É—Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
pm2 show vpn-api
pm2 show vpn-bot

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
pm2 restart vpn-api
pm2 restart vpn-bot
pm2 restart all

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
pm2 stop vpn-api
pm2 stop vpn-bot

# –ó–∞–ø—É—Å–∫
pm2 start vpn-api
pm2 start vpn-bot

# –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ PM2
pm2 delete vpn-api
pm2 delete vpn-bot
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
pm2 logs vpn-api
pm2 logs vpn-bot
pm2 logs all

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ N —Å—Ç—Ä–æ–∫
pm2 logs vpn-api --lines 100

# –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏
pm2 flush

# –õ–æ–≥–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
tail -f /var/log/kvn-deployment.log
tail -f /var/log/kvn-bot-deployment.log
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
# –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
pm2 monit

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤
pm2 status
```

## –ß–∞—Å—Ç—å 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ API

```bash
# Health check
curl http://localhost:3000/health

# –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
curl -X POST http://localhost:3000/api/v1/clients \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Test User",
    "telegram_id": 123456789,
    "subscription_days": 30,
    "traffic_limit_gb": 100
  }'

# –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤
curl http://localhost:3000/api/v1/clients
```

### –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–æ—Ç–∞

1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start` –±–æ—Ç—É –≤ Telegram
2. –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è –∞–¥–º–∏–Ω –º–µ–Ω—é (–µ—Å–ª–∏ –≤–∞—à ID = TELEGRAM_ADMIN_ID)
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `/list_clients`
4. –î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç

### –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ

1. –°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∏–µ–Ω—Ç–∞ —Å –≤–∞—à–∏–º Telegram ID —á–µ—Ä–µ–∑ `/add_client`
2. –û—Ç –∏–º–µ–Ω–∏ –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞–∂–º–∏—Ç–µ `üîë –ó–∞–ø—Ä–æ—Å–∏—Ç—å –∫–ª—é—á`
3. –í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 3 –º–µ—Å—è—Ü–∞)
4. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –¥–æ–ª–∂–µ–Ω –ø–æ–ª—É—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
5. –ù–∞–∂–º–∏—Ç–µ `‚úÖ –†–∞–∑—Ä–µ—à–∏—Ç—å`
6. –ö–ª–∏–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –ø–æ–ª—É—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ–¥–æ–±—Ä–µ–Ω–∏–∏

## –ß–∞—Å—Ç—å 6: Workflow —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –ù–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ
git clone <repo-url>
cd xray-vpn-server

# –í–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è
# ... —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ ...

# –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å
git add .
git commit -m "–î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è"

# –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ GitHub
git push origin main
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh root@144.124.237.222

# –û–±–Ω–æ–≤–∏—Ç—å API
cd /opt/xray-vpn
./scripts/kvn.sh

# –û–±–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞
cd /opt/yaronetworktool
./bot/kvn-bot.sh
```

**–°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- –ü–æ–ª—É—á–∞—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∑ Git
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—è—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ PM2
- –ü–æ–∫–∞–∂—É—Ç —Å—Ç–∞—Ç—É—Å

## –ß–∞—Å—Ç—å 7: Troubleshooting

### API –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
pm2 logs vpn-api --lines 100

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—Ç
netstat -tulpn | grep 3000

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å .env
cat /opt/xray-vpn/.env

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
sqlite3 /opt/xray-vpn/database/vpn.db ".tables"

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
pm2 restart vpn-api
```

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
pm2 logs vpn-bot --lines 100

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω
cat /opt/yaronetworktool/.env | grep TELEGRAM_BOT_TOKEN

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API
curl http://localhost:3000/health

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
pm2 restart vpn-bot
```

### –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏

```bash
# –í—Ä—É—á–Ω—É—é –æ—Ç–∫–∞—Ç–∏—Ç—å Git
cd ~/xray-vpn
git reset --hard HEAD@{1}
pm2 restart vpn-api

# –î–ª—è –±–æ—Ç–∞
cd ~/yaronetworktool
git reset --hard HEAD@{1}
pm2 restart vpn-bot
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∞

```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –±—ç–∫–∞–ø–∞
cd ~/xray-vpn-backup
ls -lt vpn_*.db | head -1  # –Ω–∞–π—Ç–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –±—ç–∫–∞–ø

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
cp vpn_20260126_123456.db ~/xray-vpn/database/vpn.db

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
pm2 restart all
```

## –ß–∞—Å—Ç—å 8: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∞–π—Ä–≤–æ–ª–∞

```bash
# –†–∞–∑—Ä–µ—à–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ—Ä—Ç—ã
ufw allow 22/tcp      # SSH
ufw allow 443/tcp     # X-Ray (HTTPS)
ufw enable

# API –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ (localhost:3000)
# –ë–æ—Ç –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ API –ª–æ–∫–∞–ª—å–Ω–æ
```

### –ó–∞—â–∏—Ç–∞ .env —Ñ–∞–π–ª–æ–≤

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞
chmod 600 ~/xray-vpn/.env
chmod 600 ~/yaronetworktool/.env

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
ls -la ~/xray-vpn/.env
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: -rw------- (—Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å)
```

### –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –±—ç–∫–∞–ø—ã

```bash
# –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –±—ç–∫–∞–ø–æ–≤
mkdir -p ~/xray-vpn-backup

# –°–æ–∑–¥–∞—Ç—å cron –∑–∞–¥–∞—á—É –¥–ª—è –±—ç–∫–∞–ø–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
crontab -e

# –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É (–±—ç–∫–∞–ø –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00)
0 3 * * * cp ~/xray-vpn/database/vpn.db ~/xray-vpn-backup/vpn_daily_$(date +\%Y\%m\%d).db
```

## –†–µ–∑—é–º–µ

‚úÖ **API –∑–∞–ø—É—â–µ–Ω:** http://localhost:3000 (PM2: vpn-api)
‚úÖ **–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω:** PM2: vpn-bot
‚úÖ **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** ./scripts/kvn.sh –∏ ./bot/kvn-bot.sh
‚úÖ **–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫:** PM2 startup –Ω–∞—Å—Ç—Ä–æ–µ–Ω
‚úÖ **–ë—ç–∫–∞–ø—ã:** –ù–∞—Å—Ç—Ä–æ–π—Ç–µ cron –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –±—ç–∫–∞–ø–∞ –ë–î

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
```bash
pm2 status                    # –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pm2 logs                      # –õ–æ–≥–∏ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
cd ~/xray-vpn && ./scripts/kvn.sh              # –û–±–Ω–æ–≤–∏—Ç—å API
cd ~/yaronetworktool && ./bot/kvn-bot.sh       # –û–±–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞
cd ~/xray-vpn && ./scripts/kvn-stop.sh         # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å API
cd ~/yaronetworktool && ./bot/kvn-bot-stop.sh  # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞
```

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ! üöÄ
